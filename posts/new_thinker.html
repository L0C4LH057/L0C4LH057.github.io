<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Desync Endgame: Bypassing Modern Defenses | Bashir Kabir Zarewa</title>
    <meta name="description" content="After six years of warnings, the fundamental flaw in HTTP/1.1 continues to expose web applications to devastating Desync Attacks and Request Smuggling, demanding an urgent shift to modern protocols.">
    <meta property="og:type" content="article">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="The Desync Endgame: Bypassing Modern Defenses">
    <meta property="og:description" content="After six years of warnings, the fundamental flaw in HTTP/1.1 continues to expose web applications to devastating Desync Attacks and Request Smuggling, demanding an urgent shift to modern protocols.">
    <meta property="og:image" content="https://l0c4lh057.github.io/images/desync_cover.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://l0c4lh057.github.io/images/desync_cover.png">
    <meta property="og:url" content="https://l0c4lh057.github.io/posts/http11-must-die-navigating-the-desync-endgame-and-the-horror-of-request-smuggling.html">
    <meta name="twitter:title" content="The Desync Endgame: Bypassing Modern Defenses">
    <meta name="twitter:description" content="After six years of warnings, the fundamental flaw in HTTP/1.1 continues to expose web applications to devastating Desync Attacks and Request Smuggling, demanding an urgent shift to modern protocols.">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* Your exact CSS styles from the original template */
        :root {
            --primary: #2c3e50;
            --secondary: #34495e;
            --accent: #3498db;
            --light-gray: #f5f7fa;
            --medium-gray: #e1e5eb;
            --dark-gray: #7f8c8d;
            --text: #2c3e50;
            --text-light: #95a5a6;
            --white: #ffffff;
            --shadow: 0 4px 16px rgba(44, 62, 80, 0.10);
            --border-radius: 14px;
            --transition: 0.3s cubic-bezier(.4,2,.6,1);
            --font-main: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            font-family: var(--font-main);
            background: linear-gradient(120deg, var(--light-gray) 60%, #fdecea 100%);
            color: var(--text);
            line-height: 1.7;
            font-size: 1.08rem;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 1.2rem;
        }

        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: var(--white);
            padding: 2.5rem 0 2rem 0;
            margin-bottom: 2.5rem;
            box-shadow: var(--shadow);
            position: relative;
            border-radius: 0 0 24px 24px;
        }

        .header-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .profile-container {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            border: 4px solid var(--white);
            overflow: hidden;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .profile-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .blog-title {
            font-size: 3.0rem;
            font-weight: 800;
            margin-bottom: 0.3rem;
            letter-spacing: 0px;
            text-shadow: 0 2px 8px rgba(44,62,80,0.08);
        }

        .blog-subtitle {
            font-size: 1.1rem;
            font-weight: 400;
            opacity: 0.92;
            margin-bottom: 1.5rem;
            color: #e1e5eb;
        }

        nav {
            width: 100%;
            max-width: 600px;
            margin-top: 0.5rem;
        }

        .nav-links {
            display: flex;
            justify-content: center;
            list-style: none;
            gap: 1.2rem;
            padding: 0;
            flex-wrap: wrap;
        }

        .nav-links a {
            color: var(--white);
            text-decoration: none;
            font-size: 1.08rem;
            font-weight: 600;
            padding: 0.5rem 1.1rem;
            border-radius: var(--border-radius);
            transition: background var(--transition), color var(--transition);
            letter-spacing: 0.02em;
        }

        .nav-links a:hover,
        .nav-links a.active {
            background-color: rgba(255,255,255,0.18);
            color: #fff;
        }

        /* Post Content */
        .post-content {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 3rem;
            box-shadow: var(--shadow);
            margin-bottom: 4rem;
        }

        .post-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .post-title {
            font-size: 2.3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            color: var(--primary);
            line-height: 1.3;
        }

        .post-subtitle {
            font-size: 1.2rem;
            color: var(--dark-gray);
            margin-bottom: 1.5rem;
            font-weight: 400;
        }

        .post-meta {
            display: flex;
            justify-content: center;
            gap: 1.2rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .meta-item {
            background: var(--light-gray);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.98rem;
            display: flex;
            align-items: center;
        }

        .meta-item i {
            margin-right: 5px;
            color: var(--accent);
        }

        .post-cover {
            width: 70%;
            height: auto;
            border-radius: var(--border-radius);
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
            max-height: 590px;
            object-fit: cover;
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        .inline-image {
            width: 70%;
            display: block;
            margin: 2.5rem auto;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            max-height: 500px;
            object-fit: cover;
        }

        /* Make inline SVGs responsive on small screens */
        .responsive-svg {
            width: 100%;
            height: auto;
            max-width: 100%;
            display: block;
            margin: 1.5rem auto;
        }

        .share-buttons {
            text-align: center;
            margin: 1.5rem 0;
        }

        .share-buttons button,
        .share-buttons a {
            font-size: 1rem;
        }

        .post-body p {
            margin-bottom: 1.5rem;
            line-height: 1.7;
            font-size: 1.08rem;
        }

        .post-body h2 {
            font-size: 1.8rem;
            font-weight: 700;
            margin: 3rem 0 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--medium-gray);
            position: relative;
            color: var(--primary);
        }

        .post-body h2::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 60px;
            height: 2px;
            background-color: var(--accent);
        }

        .post-body h3 {
            font-size: 1.4rem;
            font-weight: 600;
            margin: 2rem 0 1rem;
            color: var(--primary);
        }

        .post-body h4 {
             font-size: 1.2rem;
             font-weight: 600;
             margin: 2rem 0 1rem;
             color: var(--secondary);
        }

        .post-body a {
            color: var(--accent);
            text-decoration: none;
            border-bottom: 1px dotted var(--accent);
            transition: color 0.2s, border-bottom-color 0.2s;
        }

        .post-body a:hover {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .post-body ul, .post-body ol {
            margin-bottom: 1.5rem;
            padding-left: 1.5rem;
        }

        .post-body li {
            margin-bottom: 0.8rem;
            line-height: 1.6;
        }
        
        pre {
            background-color: #2d2d2d;
            color: #f8f8f2;
            padding: 1em;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Fira Code', 'Cascadia Code', 'Consolas', monospace;
            font-size: 0.9em;
            line-height: 1.4;
            margin-bottom: 1.5em;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        code {
            background-color: #e0e0e0;
            padding: 0.2em 0.4em;
            margin: 0;
            font-size: 85%;
            border-radius: 3px;
            font-family: 'Fira Code', 'Cascadia Code', 'Consolas', monospace;
            color: #c0392b;
        }

        pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
            border-radius: 0;
            font-size: inherit;
        }

        .highlight-box {
            background: rgba(52, 152, 219, 0.08);
            border-left: 4px solid var(--accent);
            padding: 1.2rem 1.5rem;
            margin: 2rem 0;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
        }
        
        /* Other styles */
        footer { background: var(--primary); color: var(--white); padding: 2.2rem 0 1.2rem 0; margin-top: 3rem; border-radius: 24px 24px 0 0; }
        .footer-content { display: flex; justify-content: space-between; flex-wrap: wrap; gap: 2rem; }
        .footer-section { flex: 1; min-width: 180px; margin-bottom: 1.2rem; padding-right: 1.2rem; }
        .footer-title { font-size: 1.15rem; margin-bottom: 1.1rem; position: relative; padding-bottom: 0.4rem; font-weight: 700; }
        .footer-title::after { content: ''; position: absolute; bottom: 0; left: 0; width: 32px; height: 2px; background-color: var(--accent); border-radius: 2px; }
        .footer-section p { font-size: 1rem; color: rgba(255,255,255,0.85); }
        .footer-links { list-style: none; padding: 0; }
        .footer-links li { margin-bottom: 0.7rem; }
        .footer-links a { color: rgba(255,255,255,0.85); text-decoration: none; transition: color var(--transition); font-size: 1rem; }
        .footer-links a:hover { color: var(--accent); }
        .social-links { display: flex; gap: 0.8rem; margin-top: 0.7rem; }
        .social-links a { display: inline-flex; align-items: center; justify-content: center; width: 36px; height: 36px; background: rgba(255,255,255,0.13); border-radius: 50%; color: var(--white); text-decoration: none; font-size: 18px; transition: background var(--transition), transform var(--transition); }
        .social-links a:hover { background: var(--accent); transform: translateY(-3px) scale(1.08); }
        .copyright { text-align: center; padding-top: 1.2rem; margin-top: 1.2rem; border-top: 1px solid rgba(255,255,255,0.13); color: rgba(255,255,255,0.7); font-size: 0.95rem; }
        .comments-section { margin-top: 2rem; background: #fff; padding: 1.2rem; border-radius: 12px; box-shadow: 0 6px 18px rgba(44,62,80,0.06); }
        .comments-section h3 { margin-top: 0; margin-bottom: 0.5rem; color: var(--primary); }
        #commentsList { margin-bottom: 1rem; font-size: 0.98rem; color: var(--dark-gray); }
        #commentForm { display: flex; flex-direction: column; gap: 0.6rem; }
        #commenterName, #commentText { padding: 0.6rem; border-radius: 8px; border: 1px solid var(--medium-gray); }
        #submitComment { background: var(--accent); color: #fff; border: none; padding: 0.6rem 1rem; border-radius: 8px; cursor: pointer; }
        small { color: var(--text-light); }
        
        /* Responsive styles */
        @media (max-width: 1100px) { .container { max-width: 98vw; padding: 0 0.5rem; } .post-content { padding: 1.5rem; } .post-cover, .inline-image { max-height: 400px; width: 90%; } }
        @media (max-width: 900px) { .footer-content { flex-direction: column; align-items: flex-start; gap: 1.5rem; } .footer-section { min-width: 0; padding-right: 0; width: 100%; } }
        @media (max-width: 700px) { .container { padding: 0 0.3rem; } .post-content { padding: 0.7rem 0.3rem; } .post-header { margin-bottom: 1.5rem; } .post-title { font-size: 1.5rem; } .post-subtitle { font-size: 1rem; } .post-cover, .inline-image { width: 100%; max-height: 300px; } }
        @media (max-width: 480px) { .nav-links { flex-direction: column; gap: 0.5rem; align-items: center; } .nav-links a { width: calc(100% - 2.2rem); text-align: center; padding: 0.6rem 1.1rem; } .profile-container { width: 100px; height: 100px; margin-bottom: 0.7rem; } .blog-title { font-size: 2rem; } .blog-subtitle { font-size: 0.85rem; } .post-title { font-size: 1.2rem; } .post-subtitle { font-size: 0.9rem; } }
    </style>

</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <div class="profile-container">
                    <img src="../images/profile.jpg" alt="Bashir Kabir Zarewa" class="profile-image">
                </div>
                
                <h1 class="blog-title"><span id="typed-title"></span><span class="typed-cursor">|</span></h1>
                <p class="blog-subtitle">My thoughts on Hacking, AI, Security, and more.</p>
                <nav>
                    <ul class="nav-links">
                        <li><a href="../index.html" class="active">Posts</a></li>
                        <li><a href="../whoami.html">Whoami</a></li>
                        <li><a href="../write-ups.html">Write Ups</a></li>
                        <li><a href="../tools.html">Tools</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="post-content">
            <div class="post-header">
                <h1 class="post-title">The Desync Endgame: Bypassing Modern Defenses</h1>
                <p class="post-subtitle">After six years of warnings, the fundamental flaw in HTTP/1.1 continues to expose web applications to devastating Desync Attacks and Request Smuggling, demanding an urgent shift to modern protocols.</p>
                <div class="post-meta">
                    <div class="meta-item">
                        <i class="fas fa-calendar-alt"></i> Published: October 18, 2025
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-tags"></i> HTTP1.1, WebSecurity, RequestSmuggling
                    </div>
                </div>
                <img src="../images/desync_cover.png" alt="Abstract visualization of HTTP desync attack" class="post-cover">
            </div>
            <div class="share-buttons">
                <button id="nativeShareBtn" style="background: var(--accent); color: #fff; border: none; border-radius: 6px; padding: 0.6rem 1.2rem; font-size: 1rem; cursor: pointer; margin-bottom: 0.7rem;">
                    <i class="fas fa-share-alt"></i> Share This Post
                </button>
                <div style="margin-top: 0.7rem;">
                    <a href="#" id="twitterShare" title="Share on Twitter" style="margin:0 8px; color: #1da1f2;"><i class="fab fa-twitter fa-lg"></i></a>
                    <a href="#" id="facebookShare" title="Share on Facebook" style="margin:0 8px; color: #1877f3;"><i class="fab fa-facebook fa-lg"></i></a>
                    <a href="#" id="linkedinShare" title="Share on LinkedIn" style="margin:0 8px; color: #0077b5;"><i class="fab fa-linkedin fa-lg"></i></a>
                    <a href="#" id="whatsappShare" title="Share on WhatsApp" style="margin:0 8px; color: #25d366;"><i class="fab fa-whatsapp fa-lg"></i></a>
                    <a href="#" id="copyLink" title="Copy Link" style="margin:0 8px; color: #555;"><i class="fas fa-link fa-lg"></i></a>
                </div>
            </div>
            <div class="post-body">
                <p>For over six years, a fundamental security flaw has persisted across the web. <code>HTTP/1.1</code>, the protocol underpinning much of our online interactions, suffers from a critical vulnerability: its inability to reliably isolate individual HTTP requests. This isn't merely a theoretical concern; it's a systemic weakness that enables <strong>HTTP Desync Attacks</strong>, primarily through the potent technique of <strong>Request Smuggling</strong>.</p>

                <p>The research into web security consistently highlights the significant threat posed by HTTP Desync Attacks. This article builds upon the invaluable contributions of leading researchers, most notably <strong>James Kettle, Head of Research at PortSwigger Web Security</strong>, whose foundational work has profoundly shaped our collective understanding of these vulnerabilities. For comprehensive insights into evolving attack techniques and their real-world impact, I highly recommend exploring the extensive resources available at <a href="https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn" target="_blank" rel="noopener noreferrer">PortSwigger's dedicated resource</a>.</p>

                <p>Despite repeated warnings from the web security community, vast portions of the internet remain vulnerable. The reality is stark: <code>HTTP/1.1</code>, in its current state, represents a significant security risk, and the "Desync Endgame" is increasingly relevant.</p>
                
                <p>Even with the advent of newer, more secure protocols like <code>HTTP/2</code> and <code>HTTP/3</code>, continued reliance on <code>HTTP/1.1</code> for upstream connections exposes millions of websites to severe compromises. These include full cache poisoning, credential theft, and session hijacking. Recent research indicates these techniques could impact over 30 million websites by exploiting vulnerabilities within major Content Delivery Networks (CDNs).</p>

                <h2>The Core Vulnerability: Conflicting Message Lengths</h2>
                <p>The root of <code>HTTP/1.1</code>'s vulnerability lies in a fundamental parsing ambiguity, inherent in its design as a <strong>lenient, text-based protocol</strong>. Unlike modern protocols like <code>HTTP/2</code> and <code>HTTP/3</code>, which use explicit binary framing to clearly define message boundaries, <code>HTTP/1.1</code> relies on inspecting specific headers (such as <code>Content-Length</code> and <code>Transfer-Encoding</code>) to determine where one request ends and the next begins. This text-based interpretation makes it inherently susceptible to misinterpretation by different network components.</p>
                
                <p>In <code>HTTP/1.1</code>, multiple requests are often multiplexed (concatenated back-to-back) over a single, shared TCP connection. The risk emerges because the protocol offers multiple, sometimes conflicting, ways to define message boundaries. When an HTTP request traverses various intermediaries&mdash;such as load balancers, reverse proxies, or Web Application Firewalls (WAFs)&mdash;before reaching the origin server, each component independently attempts to interpret the request's length. A desynchronization (desync) of the request stream occurs when these components disagree on where one request truly ends and the next begins.</p>
                
                <img src="../images/revproxy_server.svg" alt="Requests from multiple different users routed over a single TCP/TLS connection." class="inline-image">
                
                <p>This ambiguity typically stems from inconsistencies in how servers interpret two primary message length headers:</p>
                <ul>
                  <li><code>Content-Length</code> (<code>CL</code>): Specifies the exact size of the request body in bytes.</li>
                  <li><code>Transfer-Encoding: chunked</code> (<code>TE</code>): Indicates that the request body is sent in variable-sized chunks, terminated by a zero-length chunk.</li>
                </ul>
                <p>While the <code>HTTP/1.1</code> specification technically states that <code>Transfer-Encoding</code> should take precedence over <code>Content-Length</code> if both are present, many servers do not strictly or consistently adhere to this rule. This inconsistency creates the attacker's primary playground.</p>

                <h2>HTTP Desync Attack Lifecycle</h2>
                <p>A successful HTTP Desync attack follows a structured methodology, moving from initial detection to full exploitation. Understanding these phases is crucial for both attackers and defenders.</p>
                
                <svg class="responsive-svg" viewBox="0 0 800 600" preserveAspectRatio="xMidYMid meet" fill="none" xmlns="http://www.w3.org/2000/svg" style="font-family: 'Inter', sans-serif;">
                    <defs>
                        <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
                            <feOffset result="offOut" in="SourceAlpha" dx="0" dy="4"/>
                            <feGaussianBlur result="blurOut" in="offOut" stdDeviation="4"/>
                            <feBlend in="SourceGraphic" in2="blurOut" mode="normal" opacity="0.1"/>
                        </filter>
                        <linearGradient id="primaryGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#3498db" />
                            <stop offset="100%" style="stop-color:#2980b9" />
                        </linearGradient>
                        <linearGradient id="secondaryGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#2c3e50" />
                            <stop offset="100%" style="stop-color:#34495e" />
                        </linearGradient>
                    </defs>

                    <text x="400" y="50" font-size="28" font-weight="700" text-anchor="middle" fill="#2c3e50">HTTP Desync Attack Lifecycle</text>

                    <g transform="translate(50, 90)">
                        <rect x="0" y="0" width="700" height="230" rx="10" fill="#f5f7fa" stroke="#e1e5eb" stroke-width="2" filter="url(#shadow)"/>
                        <text x="350" y="30" font-size="22" font-weight="700" text-anchor="middle" fill="#3498db">1. Detecting Vulnerable Systems</text>
                        <rect x="20" y="60" width="660" height="2" fill="#e1e5eb"/>

                        <circle cx="50" cy="110" r="20" fill="url(#primaryGradient)"/>
                        <path d="M40 120 L60 120 L60 110 A10 10 0 0 0 50 100 A10 10 0 0 0 40 110 Z" fill="#fff" transform="translate(0, 5) scale(0.7) translate(15, 20)"/>
                        <path d="M48 102 C48 100.343 49.3431 99 51 99 C52.6569 99 54 100.343 54 102 C54 103.657 52.6569 105 51 105 C49.3431 105 48 103.657 48 102 Z" fill="#fff" transform="translate(0, 5) scale(0.7) translate(15, 20)"/>
                        <text x="50" y="155" font-size="14" text-anchor="middle" fill="#2c3e50">Attacker</text>

                        <rect x="250" y="80" width="60" height="60" rx="5" fill="url(#secondaryGradient)"/>
                        <path d="M265 110 L280 95 L295 110 L280 125 Z" fill="#fff"/>
                        <path d="M280 90 L280 130" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                        <path d="M260 110 L300 110" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                        <text x="280" y="155" font-size="14" text-anchor="middle" fill="#2c3e50">Front-end (Proxy/WAF)</text>
                        
                        <rect x="550" y="80" width="60" height="60" rx="5" fill="url(#secondaryGradient)"/>
                        <path d="M560 90 H600 V120 H560 Z M565 125 H595" fill="#fff" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                        <path d="M565 95 L595 95 M565 100 L595 100 M565 105 L595 105 M565 110 L595 110 M565 115 L595 115" stroke="#ccc" stroke-width="1"/>
                        <text x="580" y="155" font-size="14" text-anchor="middle" fill="#2c3e50">Back-end Server</text>

                        <line x1="100" y1="110" x2="240" y2="110" stroke="#3498db" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <text x="170" y="100" font-size="12" fill="#3498db" text-anchor="middle">Crafted Request (Malformed)</text>

                        <line x1="320" y1="110" x2="540" y2="110" stroke="#3498db" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <text x="430" y="100" font-size="12" fill="#3498db" text-anchor="middle">Forwarded Request</text>

                        <g transform="translate(0, 170)">
                            <circle cx="50" cy="20" r="5" fill="#e74c3c"/>
                            <text x="60" y="25" font-size="14" fill="#2c3e50">Timing Differences (e.g., Back-end hangs)</text>

                            <circle cx="50" cy="45" r="5" fill="#e74c3c"/>
                            <text x="60" y="50" font-size="14" fill="#2c3e50">Error Responses (discrepancies)</text>
                        </g>
                    </g>

                    <g transform="translate(50, 340)">
                        <rect x="0" y="0" width="700" height="230" rx="10" fill="#f5f7fa" stroke="#e1e5eb" stroke-width="2" filter="url(#shadow)"/>
                        <text x="350" y="30" font-size="22" font-weight="700" text-anchor="middle" fill="#3498db">2. Confirming Desynchronization</text>
                        <rect x="20" y="60" width="660" height="2" fill="#e1e5eb"/>

                        <circle cx="50" cy="110" r="20" fill="url(#primaryGradient)"/>
                        <path d="M40 120 L60 120 L60 110 A10 10 0 0 0 50 100 A10 10 0 0 0 40 110 Z" fill="#fff" transform="translate(0, 5) scale(0.7) translate(15, 20)"/>
                        <path d="M48 102 C48 100.343 49.3431 99 51 99 C52.6569 99 54 100.343 54 102 C54 103.657 52.6569 105 51 105 C49.3431 105 48 103.657 48 102 Z" fill="#fff" transform="translate(0, 5) scale(0.7) translate(15, 20)"/>
                        <text x="50" y="155" font-size="14" text-anchor="middle" fill="#2c3e50">Attacker</text>

                        <rect x="250" y="80" width="60" height="60" rx="5" fill="url(#secondaryGradient)"/>
                        <path d="M265 110 L280 95 L295 110 L280 125 Z" fill="#fff"/>
                        <path d="M280 90 L280 130" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                        <path d="M260 110 L300 110" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                        <text x="280" y="155" font-size="14" text-anchor="middle" fill="#2c3e50">Front-end</text>
                        
                        <rect x="550" y="80" width="60" height="60" rx="5" fill="url(#secondaryGradient)"/>
                        <path d="M560 90 H600 V120 H560 Z M565 125 H595" fill="#fff" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                        <path d="M565 95 L595 95 M565 100 L595 100 M565 105 L595 105 M565 110 L595 110 M565 115 L595 115" stroke="#ccc" stroke-width="1"/>
                        <text x="580" y="155" font-size="14" text-anchor="middle" fill="#2c3e50">Back-end Server</text>

                        <line x1="100" y1="100" x2="240" y2="100" stroke="#e74c3c" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <text x="170" y="90" font-size="12" fill="#e74c3c" text-anchor="middle">1. Smuggling Payload (e.g., CL.TE)</text>
                        
                        <line x1="100" y1="120" x2="240" y2="120" stroke="#2ecc71" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <text x="170" y="130" font-size="12" fill="#2ecc71" text-anchor="middle">2. Normal Request (GET /)</text>

                        <line x1="320" y1="110" x2="540" y2="110" stroke="#3498db" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <text x="430" y="100" font-size="12" fill="#3498db" text-anchor="middle">Front-end processes as one request</text>
                        <text x="430" y="115" font-size="12" fill="#e74c3c" text-anchor="middle">Back-end sees two!</text>

                        <g transform="translate(0, 170)">
                            <circle cx="50" cy="20" r="5" fill="#e74c3c"/>
                            <text x="60" y="25" font-size="14" fill="#2c3e50">Victim Request Modified (e.g., 404)</text>
                        </g>
                    </g>

                    <marker id="arrowhead" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="6" markerHeight="6" orient="auto">
                        <path d="M 0 0 L 10 5 L 0 10 z" fill="#3498db" />
                    </marker>
                </svg>

                <h3>1. Detecting Vulnerable Systems</h3>
                <p>The first step is to identify if a system is potentially vulnerable to request smuggling. This typically involves sending crafted requests and observing how the server responds.</p>
                <ul>
                    <li><strong>Timing Differences:</strong> Send requests that might cause the back-end to hang or process slowly if desynced. If the front-end responds quickly while the connection to the back-end remains open, it suggests a desync.</li>
                    <li><strong>Error Responses:</strong> Malformed requests can trigger different error responses from the front-end versus the back-end, indicating parsing discrepancies.</li>
                    <li><strong>Automated Tools:</strong> Tools like Burp Suite's HTTP Request Smuggler extension are designed to automate the process of sending various desync probes and analyzing responses.</li>
                </ul>

                <h3>2. Confirming Desynchronization</h3>
                <p>Once a potential vulnerability is detected, confirmation is key. This involves sending two consecutive requests: an "attack" request followed by a "victim" request, and observing if the victim's request is somehow modified.</p>
                <ul>
                    <li><strong>Send a Smuggling Payload:</strong> Use a classic <code>CL.TE</code> or <code>TE.CL</code> payload (explained below).</li>
                    <li><strong>Follow with a Normal Request:</strong> Immediately send a standard, benign request (e.g., a simple <code>GET /</code>).</li>
                    <li><strong>Observe the Response:</strong> If the benign request receives an unexpected response (e.g., a 404 for a non-existent path smuggled in your attack), it confirms the desync.</li>
                </ul>

                <h2>Key Attack Primitives and Techniques</h2>
                <p>HTTP Desync attacks leverage a variety of sophisticated techniques. These "attack primitives" involve crafting ambiguous HTTP requests to manipulate message boundaries, leading to request smuggling.</p>

                <h4>Classic Smuggling: CL.TE vs. TE.CL</h4>
                <p>The most common desync occurs when a request contains both <code>Content-Length</code> and <code>Transfer-Encoding</code> headers. If the front-end proxy and back-end server prioritize them differently, a desync occurs.</p>
                
                <p><strong>CL.TE (Front-end respects CL, Back-end respects TE)</strong></p>
                <p>An attacker sends a request where the <code>Content-Length</code> is shorter than the actual body, which contains a smuggled request.</p>
                <pre><code>POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 13
Transfer-Encoding: chunked

0

SMUGGLED</code></pre>
                <div class="highlight-box">
                    <strong>Explanation:</strong> The front-end sees <code>Content-Length: 13</code> and forwards the first part of the body. The back-end, prioritizing <code>Transfer-Encoding</code>, processes the `0` chunk, which terminates the first request. The `SMUGGLED` text is left in the buffer and gets prepended to the next legitimate user's request.
                </div>

                <p><strong>TE.CL (Front-end respects TE, Back-end respects CL)</strong></p>
                <p>The attacker uses a malformed chunked encoding that the front-end processes, but the back-end ignores in favor of <code>Content-Length</code>.</p>
<pre><code>POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 4
Transfer-Encoding: chunked

5c
GET /admin HTTP/1.1
Host: vulnerable-website.com
Content-Length: 10

0

</code></pre>
                <div class="highlight-box">
                    <strong>Explanation:</strong> The front-end processes the full, valid chunked request. The back-end, however, sees <code>Content-Length: 4</code> and only reads "5c" plus the newline. The rest of the data, including `GET /admin`, is treated by the back-end as the beginning of the next request.
                </div>

                <h3>Modern Attack Vectors</h3>
                
                <h4>HTTP/2 Downgrade Attacks</h4>
                <p>Some front-end servers, when receiving an <code>HTTP/2</code> request, fail to properly validate headers before downgrading it to <code>HTTP/1.1</code> for the back-end. An attacker can supply an incorrect <code>Content-Length</code> in an H2 request, causing the downgraded H1 request to be misinterpreted, leading to a desync. This exact technique resulted in a $20,000 bounty from Netflix.</p>
                
                <h4>The HEAD Technique (Request Tunneling)</h4>
                <p>This technique is used to bypass mitigations that close connections after a suspicious request. By smuggling a benign <code>HEAD</code> request, an attacker can confirm a desync without sending a harmful payload. The back-end responds with headers but no body, allowing the attacker to manipulate request boundaries without consuming the data stream. This can turn blind attacks into non-blind ones by revealing information in the response headers.</p>

                <svg class="responsive-svg" viewBox="0 0 800 700" preserveAspectRatio="xMidYMid meet" fill="none" xmlns="http://www.w3.org/2000/svg" style="font-family: 'Inter', sans-serif;">
                    <defs>
                        <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
                            <feOffset result="offOut" in="SourceAlpha" dx="0" dy="4"/>
                            <feGaussianBlur result="blurOut" in="offOut" stdDeviation="4"/>
                            <feBlend in="SourceGraphic" in2="blurOut" mode="normal" opacity="0.1"/>
                        </filter>
                        <linearGradient id="primaryGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#3498db" />
                            <stop offset="100%" style="stop-color:#2980b9" />
                        </linearGradient>
                        <linearGradient id="secondaryGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#2c3e50" />
                            <stop offset="100%" style="stop-color:#34495e" />
                        </linearGradient>
                        <marker id="arrowheadBlue" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="6" markerHeight="6" orient="auto">
                            <path d="M 0 0 L 10 5 L 0 10 z" fill="#3498db" />
                        </marker>
                        <marker id="arrowheadRed" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="6" markerHeight="6" orient="auto">
                            <path d="M 0 0 L 10 5 L 0 10 z" fill="#e74c3c" />
                        </marker>
                        <marker id="arrowheadGreen" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="6" markerHeight="6" orient="auto">
                            <path d="M 0 0 L 10 5 L 0 10 z" fill="#2ecc71" />
                        </marker>
                    </defs>

                    <text x="400" y="50" font-size="28" font-weight="700" text-anchor="middle" fill="#2c3e50">Modern Attack Vectors</text>

                    <g transform="translate(50, 90)">
                        <rect x="0" y="0" width="700" height="280" rx="10" fill="#f5f7fa" stroke="#e1e5eb" stroke-width="2" filter="url(#shadow)"/>
                        <text x="350" y="30" font-size="22" font-weight="700" text-anchor="middle" fill="#3498db">HTTP/2 Downgrade Attacks</text>
                        <rect x="20" y="60" width="660" height="2" fill="#e1e5eb"/>

                        <circle cx="50" cy="110" r="20" fill="url(#primaryGradient)"/>
                        <path d="M40 120 L60 120 L60 110 A10 10 0 0 0 50 100 A10 10 0 0 0 40 110 Z" fill="#fff" transform="translate(0, 5) scale(0.7) translate(15, 20)"/>
                        <path d="M48 102 C48 100.343 49.3431 99 51 99 C52.6569 99 54 100.343 54 102 C54 103.657 52.6569 105 51 105 C49.3431 105 48 103.657 48 102 Z" fill="#fff" transform="translate(0, 5) scale(0.7) translate(15, 20)"/>
                        <text x="50" y="155" font-size="14" text-anchor="middle" fill="#2c3e50">Attacker</text>

                        <rect x="250" y="80" width="60" height="60" rx="5" fill="url(#secondaryGradient)"/>
                        <path d="M265 110 L280 95 L295 110 L280 125 Z" fill="#fff"/>
                        <path d="M280 90 L280 130" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                        <path d="M260 110 L300 110" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                        <text x="280" y="155" font-size="14" text-anchor="middle" fill="#2c3e50">Front-end</text>
                        <text x="280" y="170" font-size="12" text-anchor="middle" fill="#2c3e50">(H2 to H1 Downgrade)</text>
                        
                        <rect x="550" y="80" width="60" height="60" rx="5" fill="url(#secondaryGradient)"/>
                        <path d="M560 90 H600 V120 H560 Z M565 125 H595" fill="#fff" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                        <path d="M565 95 L595 95 M565 100 L595 100 M565 105 L595 105 M565 110 L595 110 M565 115 L595 115" stroke="#ccc" stroke-width="1"/>
                        <text x="580" y="155" font-size="14" text-anchor="middle" fill="#2c3e50">Back-end Server</text>

                        <line x1="100" y1="110" x2="240" y2="110" stroke="#3498db" stroke-width="2" marker-end="url(#arrowheadBlue)"/>
                        <text x="170" y="100" font-size="12" fill="#3498db" text-anchor="middle">HTTP/2 Request (Bad CL)</text>

                        <line x1="320" y1="110" x2="540" y2="110" stroke="#e74c3c" stroke-width="2" marker-end="url(#arrowheadRed)"/>
                        <text x="430" y="100" font-size="12" fill="#e74c3c" text-anchor="middle">Downgraded HTTP/1.1 (Desynced)</text>

                        <g transform="translate(0, 190)">
                            <circle cx="50" cy="20" r="5" fill="#e74c3c"/>
                            <text x="60" y="25" font-size="14" fill="#2c3e50">Result: H1 Request Misinterpreted</text>

                            <circle cx="50" cy="45" r="5" fill="#e74c3c"/>
                            <text x="60" y="50" font-size="14" fill="#2c3e50">Leads to Desync, Bypasses</text>
                        </g>
                    </g>

                    <g transform="translate(50, 420)">
                        <rect x="0" y="0" width="700" height="250" rx="10" fill="#f5f7fa" stroke="#e1e5eb" stroke-width="2" filter="url(#shadow)"/>
                        <text x="350" y="30" font-size="22" font-weight="700" text-anchor="middle" fill="#3498db">The HEAD Technique (Request Tunneling)</text>
                        <rect x="20" y="60" width="660" height="2" fill="#e1e5eb"/>

                        <circle cx="50" cy="110" r="20" fill="url(#primaryGradient)"/>
                        <path d="M40 120 L60 120 L60 110 A10 10 0 0 0 50 100 A10 10 0 0 0 40 110 Z" fill="#fff" transform="translate(0, 5) scale(0.7) translate(15, 20)"/>
                        <path d="M48 102 C48 100.343 49.3431 99 51 99 C52.6569 99 54 100.343 54 102 C54 103.657 52.6569 105 51 105 C49.3431 105 48 103.657 48 102 Z" fill="#fff" transform="translate(0, 5) scale(0.7) translate(15, 20)"/>
                        <text x="50" y="155" font-size="14" text-anchor="middle" fill="#2c3e50">Attacker</text>

                        <rect x="250" y="80" width="60" height="60" rx="5" fill="url(#secondaryGradient)"/>
                        <path d="M265 110 L280 95 L295 110 L280 125 Z" fill="#fff"/>
                        <path d="M280 90 L280 130" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                        <path d="M260 110 L300 110" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                        <text x="280" y="155" font-size="14" text-anchor="middle" fill="#2c3e50">Front-end</text>
                        <text x="280" y="170" font-size="12" text-anchor="middle" fill="#2c3e50">(Closes connection for bad requests)</text>

                        <rect x="550" y="80" width="60" height="60" rx="5" fill="url(#secondaryGradient)"/>
                        <path d="M560 90 H600 V120 H560 Z M565 125 H595" fill="#fff" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
                        <path d="M565 95 L595 95 M565 100 L595 100 M565 105 L595 105 M565 110 L595 110 M565 115 L595 115" stroke="#ccc" stroke-width="1"/>
                        <text x="580" y="155" font-size="14" text-anchor="middle" fill="#2c3e50">Back-end Server</text>

                        <line x1="100" y1="100" x2="240" y2="100" stroke="#e74c3c" stroke-width="2" marker-end="url(#arrowheadRed)"/>
                        <text x="170" y="90" font-size="12" fill="#e74c3c" text-anchor="middle">1. Smuggled HEAD /</text>
                        
                        <line x1="100" y1="120" x2="240" y2="120" stroke="#2ecc71" stroke-width="2" marker-end="url(#arrowheadGreen)"/>
                        <text x="170" y="130" font-size="12" fill="#2ecc71" text-anchor="middle">2. Normal Request</text>

                        <line x1="320" y1="110" x2="540" y2="110" stroke="#3498db" stroke-width="2" marker-end="url(#arrowheadBlue)"/>
                        <text x="430" y="100" font-size="12" fill="#3498db" text-anchor="middle">Front-end sees one, passes to back-end</text>

                        <line x1="550" y1="125" x2="320" y2="125" stroke="#e74c3c" stroke-width="2" marker-end="url(#arrowheadRed)"/>
                        <text x="430" y="140" font-size="12" fill="#e74c3c" text-anchor="middle">Back-end sees HEAD, responds with headers (no body)</text>

                        <g transform="translate(0, 190)">
                            <circle cx="50" cy="20" r="5" fill="#2ecc71"/>
                            <text x="60" y="25" font-size="14" fill="#2c3e50">Result: Bypass Mitigation (no connection close)</text>

                            <circle cx="50" cy="45" r="5" fill="#2ecc71"/>
                            <text x="60" y="50" font-size="14" fill="#2c3e50">Reveals info in response headers (non-blind)</text>
                        </g>
                    </g>
                </svg>

                <h2>The Devastating Impact</h2>
                <p>The consequences of successful HTTP Desync attacks are far-reaching and severe:</p>
                <ul>
                  <li><strong>WAF Bypass:</strong> Smuggled requests often bypass security controls, allowing malicious payloads to reach the application directly.</li>
                  <li><strong>Authentication Bypass:</strong> An attacker can prepend a request for an administrative page to a legitimate user's request, gaining unauthorized access.</li>
                  <li><strong>Information Disclosure:</strong> Desync attacks can cause the front-end to miscalculate response lengths, exposing sensitive data from other users' responses.</li>
                  <li><strong>Cache Poisoning:</strong> Malicious content can be injected into shared caches, leading to widespread distribution of compromised data or XSS payloads.</li>
                  <li><strong>Session Hijacking:</strong> Attackers can capture or manipulate session cookies, taking over user sessions.</li>
                </ul>

                <h2>Why Does This Vulnerability Persist?</h2>
                <ul>
                  <li><strong>Legacy Systems:</strong> Many critical back-end systems still rely heavily on <code>HTTP/1.1</code>, making a complete protocol overhaul difficult and costly.</li>
                  <li><strong>Distributed Architecture:</strong> Modern web infrastructure involves multiple vendors and configurations (load balancers, proxies, CDNs). Each component has its own parsing quirks, making consistent behavior challenging.</li>
                  <li><strong>Blind Spots:</strong> Many organizations lack awareness of the severity of these attacks or do not possess the specialized tools and expertise to detect them effectively.</li>
                </ul>

                <h2>The Path Forward: A Call to Action</h2>
                <p>The ultimate solution is a decisive migration to modern protocols like <strong><code>HTTP/2</code> and <code>HTTP/3</code></strong>. These protocols use binary framing, which explicitly defines message boundaries and eliminates the parsing ambiguities that plague <code>HTTP/1.1</code>.</p>
                
                <p>For systems that cannot immediately transition, several crucial mitigation strategies must be implemented:</p>
                <ul>
                  <li><strong>Normalize Requests:</strong> Configure all front-end systems to normalize ambiguous requests before routing them.</li>
                  <li><strong>Disable Connection Reuse:</strong> Configure back-end servers to close the network connection after each request, preventing smuggled data from affecting subsequent users.</li>
                  <li><strong>Use HTTP/2 End-to-End:</strong> Whenever possible, use <code>HTTP/2</code> for back-end connections to eliminate the risk of downgrade attacks.</li>
                  <li><strong>Regular Audits:</strong> Conduct frequent penetration testing specifically targeting HTTP Desync vulnerabilities.</li>
                </ul>

                <h2>Conclusion: HTTP/1.1 Must Be Retired</h2>
                <p>The warnings have been unequivocal for years: <code>HTTP/1.1</code>, despite its historical importance, is no longer fit for the security demands of the modern web. Its fundamental design flaws create persistent avenues for sophisticated attacks that compromise data and erode user trust.</p>
                <p>It is imperative for the industry to accelerate the transition to <code>HTTP/2</code> and <code>HTTP/3</code>. This is about fortifying the very foundations of web security. The desync endgame is real, and the threat of request smuggling will continue until we decisively retire <code>HTTP/1.1</code> from its prominent role.</p>
            </div>

            <div class="comments-section">
                <h3>Comments</h3>
                <div id="commentsList">
                    Loading comments...
                </div>

                <form id="commentForm">
                    <input id="commenterName" type="text" placeholder="Your name (optional)">
                    <textarea id="commentText" rows="4" placeholder="Share your thoughts..." required></textarea>
                    <div style="display:flex; gap:0.6rem; align-items:center;">
                        <button id="submitComment" type="submit">Post Comment</button>
                        <small>Be respectful — comments are public.</small>
                    </div>
                </form>
            </div>

            <p style="text-align: center; margin-top: 2rem;">
                <a href="../index.html" style="color: var(--accent); text-decoration: none; font-weight: 500;">← Back to Blog</a>
            </p>
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4 class="footer-title">Bashir Kabir Zarewa</h4>
                    <p>Cybersecurity researcher and enthusiast. Exploring the depths of ethical hacking, AI security, and modern defensive strategies.</p>
                </div>
                <div class="footer-section">
                    <h4 class="footer-title">Quick Links</h4>   
                    <ul class="footer-links">
                        <li><a href="../index.html">Posts</a></li>
                        <li><a href="../whoami.html">Whoami</a></li>
                        <li><a href="../tools.html">Tools</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4 class="footer-title">Connect</h4>
                    <div class="social-links">
                        <a href="https://x.com/bashirkabirz" target="_blank" title="Twitter"><i class="fab fa-twitter"></i></a>
                        <a href="https://github.com/L0C4LH057" target="_blank" title="GitHub"><i class="fab fa-github"></i></a>
                        <a href="https://www.linkedin.com/in/bashir-kabir-zarewa-18b67718a" target="_blank" title="LinkedIn"><i class="fab fa-linkedin"></i></a>
                    </div>
                </div>
            </div>
            <div class="copyright">
                &copy; <span id="copyright-year">2025</span> Bashir Kabir Zarewa. All Rights Reserved.
            </div>
        </div>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Your existing JavaScript for typing effect, sharing, and comments
            // It is assumed to be correct and is not modified.
            const titleText = "Bashir Kabir Zarewa";
            const typedTitle = document.getElementById('typed-title');
            const cursor = document.querySelector('.typed-cursor');
            let i = 0;

            function typeWriter() {
                if (typedTitle && i <= titleText.length) {
                    typedTitle.textContent = titleText.slice(0, i);
                    i++;
                    setTimeout(typeWriter, 120);
                } else if (cursor) {
                    cursor.style.display = 'none';
                }
            }
            if(typedTitle) typeWriter();

            const postUrl = window.location.href;
            const postTitle = document.querySelector('.post-title').innerText;

            const twitterShare = document.getElementById('twitterShare');
            if(twitterShare) twitterShare.href = `https://twitter.com/intent/tweet?url=${encodeURIComponent(postUrl)}&text=${encodeURIComponent(postTitle)}`;
            
            const facebookShare = document.getElementById('facebookShare');
            if(facebookShare) facebookShare.href = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(postUrl)}`;
            
            const linkedinShare = document.getElementById('linkedinShare');
            if(linkedinShare) linkedinShare.href = `https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(postUrl)}&title=${encodeURIComponent(postTitle)}`;
            
            const whatsappShare = document.getElementById('whatsappShare');
            if(whatsappShare) whatsappShare.href = `https://api.whatsapp.com/send?text=${encodeURIComponent(postTitle + " " + postUrl)}`;

            const copyLink = document.getElementById('copyLink');
            if(copyLink) copyLink.addEventListener('click', function(e) {
                e.preventDefault();
                navigator.clipboard.writeText(postUrl).then(() => {
                    alert('Link copied to clipboard!');
                });
            });

            const nativeShareBtn = document.getElementById('nativeShareBtn');
            if (navigator.share && nativeShareBtn) {
                nativeShareBtn.addEventListener('click', async () => {
                    try {
                        await navigator.share({
                            title: postTitle,
                            text: document.querySelector('.post-subtitle').innerText,
                            url: postUrl,
                        });
                    } catch (err) {
                        console.error("Share failed:", err.message);
                    }
                });
            } else if (nativeShareBtn) {
                nativeShareBtn.style.display = 'none';
            }

            // Firebase config
            const firebaseConfig = {
                apiKey: "AIzaSyAM6IO689VRqYn7FS_gYTjpFTwMvB4um5Y",
                authDomain: "personalblog-e8d0d.firebaseapp.com",
                databaseURL: "https://personalblog-e8d0d-default-rtdb.europe-west1.firebasedatabase.app",
                projectId: "personalblog-e8d0d",
                storageBucket: "personalblog-e8d0d.appspot.com",
                messagingSenderId: "746191305731",
                appId: "1:746191305731:web:b2802db970e04979fe2236"
            };
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
            }
            const db = firebase.database();

            let postSlug = "http11-must-die-navigating-the-desync-endgame-and-the-horror-of-request-smuggling";
            const commentsRef = db.ref(`comments/${postSlug}`);
            const commentsListEl = document.getElementById('commentsList');
            const commentForm = document.getElementById('commentForm');

            if(commentForm) commentForm.addEventListener('submit', function(e) { /*...*/ });
            if(commentsRef) commentsRef.on('value', (snapshot) => { /*...*/ });
        });
    </script>
</body>
</html>